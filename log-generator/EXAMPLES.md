# Log Generator Examples

This document shows examples of the different types of logs generated by the Spunk log generator.

## Apache Access Logs

Standard Apache combined log format with user, timestamp, request, status code, bytes, referer, and user agent:

```
<134>Dec 11 18:14:36 k8s-node-02 apache[8137]: 192.168.1.117 - www-data [11/Dec/2025:18:14:36 +0000] "HEAD /images/hero.jpg HTTP/1.1" 204 17151 "http://example.com/api/v1/logout" "curl/7.68.0"
```

## Nginx Access Logs

Nginx format with response time and referer:

```
<134>Dec 11 18:14:36 web-server-03 nginx[9856]: 198.51.100.88 - - "PATCH /api/v1/users HTTP/1.1" 201 43952 "-" "curl/7.68.0" rt=0.803
```

## Kubernetes Pod Logs

JSON-structured logs from Kubernetes deployments:

```
<158>Dec 11 18:14:52 k8s-node-02 k8s/production/api-deployment-7d9f8c6b4-x7k2m[123]: {"level":"info","ts":"2025-12-11T23:14:52.326Z","logger":"api","msg":"HTTP request completed","method":"POST","path":"/api/v1/users","status":201,"duration":145,"correlation_id":"1765494893345-3ea"}

<155>Dec 11 18:15:53 k8s-node-02 k8s/monitoring/redis-statefulset-0[370]: {"level":"error","ts":"2025-12-11T23:15:53.861Z","logger":"redis","msg":"Database connection failed","error":"ECONNREFUSED","host":"postgres-statefulset-0.postgres","port":5432,"correlation_id":"1765494953861-3ef"}

<158>Dec 11 18:15:52 web-server-03 k8s/production/postgres-statefulset-0[514]: {"level":"info","ts":"2025-12-11T23:15:52.489Z","logger":"postgres","msg":"Health check passed","checks":{"database":"ok","redis":"ok","disk":"ok"}}
```

## AWS CloudWatch Logs

Lambda, ECS, and EC2 style logs:

```
<163>Dec 11 18:14:53 proxmox-01 aws-cloudwatch: {"timestamp":"2025-12-11T23:14:53.345Z","level":"ERROR","requestId":"1765494893345-3ea","message":"Lambda function timeout","duration":30000,"error":"Task timed out after 30.00 seconds"}

<163>Dec 11 18:14:52 app-server-01 aws-cloudwatch: {"timestamp":"2025-12-11T23:14:52.123Z","level":"INFO","requestId":"1765494892123-3e9","message":"Lambda function executed successfully","duration":1245,"memoryUsed":256,"memoryLimit":512}
```

## Security Logs

Failed login attempts, brute force detection, SQL injection attempts:

```
<84>Dec 11 18:14:51 cache-server-01 sshd[2454]: Failed password for nobody from 192.168.1.100 port 44291 ssh2

<83>Dec 11 18:14:51 gateway-01 security[2454]: Brute force attack detected from 185.220.101.45 - 42 failed attempts in 3 minutes

<83>Dec 11 18:14:52 gateway-01 security[5214]: SQL injection attempt detected from 198.51.100.88 - query: "SELECT * FROM users WHERE id='1' OR '1'='1'"

<84>Dec 11 18:15:52 web-server-01 security[5214]: Permission denied for user 'www-data' accessing /ready - insufficient privileges

<86>Dec 11 18:16:03 k8s-node-02 security[2182]: User 'root' logged in successfully from 192.168.1.111 - correlation_id: 1765494963063-3ea

<84>Dec 11 18:15:51 gateway-01 security[2454]: Failed login attempt for user 'admin' from 185.220.101.45 - account locked after 5 attempts
```

## MySQL Query Logs

Database queries with execution time and correlation IDs:

```
<140>Dec 11 18:15:52 web-server-03 mysql[5121]: [1765494953041-3ec] admin@users Slow query (9029ms): "SELECT * FROM orders WHERE user_id = ? AND status = ?"

<142>Dec 11 18:15:53 app-server-01 mysql[3329]: [1765494953317-3ed] app@production Query: "UPDATE users SET last_login = NOW() WHERE id = ?" Time: 45ms Rows: 1

<139>Dec 11 18:15:52 cache-server-01 mysql[3329]: [1765494952349-3e9] app@analytics Query failed: Deadlock found when trying to get lock; try restarting transaction

<140>Dec 11 18:16:04 db-server-02 mysql[1040]: [1765494964404-3f0] admin@analytics Connection limit reached: max_connections=150
```

## PostgreSQL Logs

Database connection and checkpoint logs:

```
<142>Dec 11 18:14:51 firewall-01 postgres[2811]: connection received: host=198.51.100.88 port=48399

<142>Dec 11 18:14:51 firewall-01 postgres[2811]: connection authorized: user=app database=production

<140>Dec 11 18:15:54 web-server-02 postgres[3976]: temporary file: path "base/pgsql_tmp/pgsql_tmp9090.0", size 60724

<142>Dec 11 18:15:55 db-server-01 postgres[4122]: checkpoint complete: wrote 543 buffers (4.2%)

<139>Dec 11 18:16:44 db-server-01 postgres[3052]: [1765495004188-417] FATAL: connection limit exceeded for non-superusers
```

## Application Logs with Stack Traces

Multi-line Java/Python/Node.js exception traces:

```
<147>Dec 11 18:14:53 app-server-01 myapp[1767]: [ERROR] [database] [1765494893687-3eb] Unhandled exception:
Error: Database connection timeout
    at Connection.connect (/app/node_modules/pg/lib/connection.js:142)
    at Client._connect (/app/node_modules/pg/lib/client.js:67)
    at Client.connect (/app/node_modules/pg/lib/client.js:45)
    at Database.query (/app/src/database.js:42)
    at UserService.getUser (/app/src/services/user.js:89)
    at async /app/src/controllers/user.js:34

<147>Dec 11 18:15:23 web-server-02 myapp[5231]: [ERROR] [api] [1765494923456-3f4] Unhandled exception:
java.lang.NullPointerException: Cannot invoke method on null object
        at com.example.service.UserService.getUser(UserService.java:142)
        at com.example.controller.UserController.handleRequest(UserController.java:67)
        at com.example.framework.RequestDispatcher.dispatch(RequestDispatcher.java:245)
        at com.example.framework.Filter.doFilter(Filter.java:52)
        at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:52)
        at java.base/java.lang.Thread.run(Thread.java:829)

<147>Dec 11 18:15:45 app-server-03 myapp[8932]: [ERROR] [worker] [1765494945123-3fa] Unhandled exception:
Traceback (most recent call last):
  File "/app/main.py", line 156, in handle_request
    result = process_user_data(user_id)
  File "/app/services/user.py", line 78, in process_user_data
    user = User.query.get(user_id)
  File "/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 823, in get
    return self._get_impl(ident, loading.load_on_ident)
AttributeError: 'NoneType' object has no attribute 'id'
```

## SSH/Authentication Logs

Login attempts and session events:

```
<86>Dec 11 18:14:36 docker-host-01 sshd[7896]: Accepted publickey for jenkins from 192.168.1.103 port 54795 ssh2: RSA SHA256:MzfnvKnWJmK9hatpriNrMnsqouNIGrcBBDU5BBt0IdX

<84>Dec 11 18:14:51 cache-server-01 sshd[2454]: Failed password for nobody from 192.168.1.100 port 44291 ssh2

<83>Dec 11 18:14:52 gateway-01 sshd[8687]: Invalid user admin from 198.51.100.88 port 52341

<86>Dec 11 18:14:53 web-server-01 sshd[9123]: session opened for user deploy by (uid=0)

<86>Dec 11 18:15:03 web-server-01 sshd[9123]: session closed for user deploy
```

## Docker Logs

Container lifecycle and health events:

```
<30>Dec 11 18:14:37 web-server-02 dockerd[3147]: Container postgres started

<30>Dec 11 18:15:53 web-server-01 dockerd[3247]: Container nginx health check passed

<28>Dec 11 18:15:54 docker-host-02 dockerd[4300]: Container nginx high memory usage: 84%

<27>Dec 11 18:16:02 app-server-01 dockerd[2341]: Container api exited with code 137

<30>Dec 11 18:16:15 docker-host-01 dockerd[4522]: Pulling image worker:latest
```

## Firewall Logs

UFW/iptables packet filtering:

```
<6>Dec 11 18:14:38 proxmox-01 kernel: [UFW ACCEPT] IN=eth0 OUT= MAC=00:00:00:00:00:00 SRC=192.168.1.113 DST=192.168.1.1 PROTO=UDP SPT=29908 DPT=5672

<4>Dec 11 18:14:50 k8s-node-01 kernel: [UFW REJECT] IN=eth0 OUT= MAC=00:00:00:00:00:00 SRC=192.168.1.105 DST=192.168.1.1 PROTO=TCP SPT=33558 DPT=22

<4>Dec 11 18:16:44 db-server-02 kernel: [UFW DROP] IN=eth0 OUT= MAC=00:00:00:00:00:00 SRC=10.0.10.16 DST=192.168.1.1 PROTO=UDP SPT=58272 DPT=22
```

## Kernel/System Logs

Hardware events and OOM killer:

```
<6>Dec 11 18:14:36 proxmox-01 kernel: [2789.456] eth0: link up, 1000Mbps, full-duplex

<4>Dec 11 18:14:52 app-server-02 kernel: [3456.789] CPU3: Temperature above threshold, cpu clock throttled

<5>Dec 11 18:15:52 db-server-02 kernel: [6345.767] Out of memory: Killed process 5701 (java)

<3>Dec 11 18:16:12 nas-01 kernel: [7234.123] EXT4-fs error (device sda1): ext4_find_entry: reading directory lblock 0

<6>Dec 11 18:16:34 web-server-03 kernel: [8901.234] usb 2-1: new high-speed USB device number 7
```

## systemd Logs

Service management:

```
<30>Dec 11 18:14:45 app-server-01 systemd[1]: Started nginx.service - nginx daemon

<30>Dec 11 18:14:58 web-server-02 systemd[1]: Reloading docker.service - docker daemon

<27>Dec 11 18:15:23 db-server-01 systemd[1]: postgresql.service: Failed with result 'exit-code'

<28>Dec 11 18:15:45 cache-server-01 systemd[1]: redis.service: Watchdog timeout (limit 60s)!

<30>Dec 11 18:16:12 app-server-03 systemd[1]: Stopped sshd.service - sshd daemon
```

## Cron Job Logs

Scheduled task execution:

```
<78>Dec 11 18:14:52 web-server-01 CRON[12345]: (root) CMD (/usr/bin/backup.sh)

<78>Dec 11 18:15:02 app-server-02 CRON[23456]: (www-data) CMDEND (/opt/scripts/cleanup.py)

<75>Dec 11 18:15:52 cache-server-01 CRON[16024]: (root) FAILED to execute /opt/scripts/cleanup.py

<78>Dec 11 18:16:01 db-server-01 CRON[34567]: (backup) CMD (logrotate /etc/logrotate.conf)
```

## Error Cascade Example

When a database fails, multiple services report errors with the same correlation ID:

```
<139>Dec 11 18:16:44 db-server-01 postgres[3052]: [1765495004188-417] FATAL: connection limit exceeded for non-superusers
<147>Dec 11 18:16:44 app-server-01 myapp[6521]: [ERROR] [database] [1765495004188-417] Failed to connect to database: ECONNREFUSED
<147>Dec 11 18:16:44 app-server-02 myapp[3227]: [ERROR] [database] [1765495004188-417] Failed to connect to database: ECONNREFUSED
<147>Dec 11 18:16:44 app-server-03 myapp[7268]: [ERROR] [database] [1765495004188-417] Failed to connect to database: ECONNREFUSED
<131>Dec 11 18:16:44 nginx-ingress-01 nginx[4935]: [1765495004188-417] upstream server temporarily unavailable while connecting to upstream
```

All events share correlation ID `1765495004188-417`, making it easy to trace the cascade.

## Correlated Events Example

User login followed by activity with the same session ID:

```
<86>Dec 11 18:16:07 gateway-01 security[1699]: User 'backup' logged in successfully from 192.168.1.101 - correlation_id: 1765494967856-401, session_id: EwfhsehMpHv2h5EfLDMNxrMINjkEnm63
<134>Dec 11 18:16:07 web-server-01 nginx[4500]: 192.168.1.101 - backup "POST /images/logo.png HTTP/1.1" 200 891 "-" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36" rt=0.480 session=EwfhsehMpHv2h5EfLDMNxrMINjkEnm63
<134>Dec 11 18:16:07 web-server-01 nginx[2660]: 192.168.1.101 - backup "POST /admin/users HTTP/1.1" 200 4949 "-" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36" rt=0.405 session=EwfhsehMpHv2h5EfLDMNxrMINjkEnm63
<134>Dec 11 18:16:07 web-server-01 nginx[5500]: 192.168.1.101 - backup "OPTIONS /webhooks/github HTTP/1.1" 200 4559 "-" "Go-http-client/1.1" rt=0.466 session=EwfhsehMpHv2h5EfLDMNxrMINjkEnm63
<134>Dec 11 18:16:07 web-server-01 nginx[4937]: 192.168.1.101 - backup "POST /admin/dashboard HTTP/1.1" 200 3413 "-" "curl/7.68.0" rt=0.242 session=EwfhsehMpHv2h5EfLDMNxrMINjkEnm63
<86>Dec 11 18:16:07 gateway-01 security[7441]: User 'backup' logged out - session duration: 53 minutes, session_id: EwfhsehMpHv2h5EfLDMNxrMINjkEnm63
```

All events share session ID `EwfhsehMpHv2h5EfLDMNxrMINjkEnm63`, making it easy to trace user activity.

## Regular Application Logs

Standard structured application logs:

```
<151>Dec 11 18:15:53 web-server-02 myapp[9153]: [DEBUG] [database] [1765494953317-3ed] Cache hit for key: user:863

<150>Dec 11 18:15:54 app-server-01 myapp[4274]: [INFO] [api] [1765494954123-3f1] Request processed in 245ms

<148>Dec 11 18:15:53 app-server-02 myapp[9409]: [WARN] [database] [1765494953455-3ee] Retrying failed operation, attempt 3

<147>Dec 11 18:15:54 cache-server-01 myapp[5621]: [ERROR] [cache] [1765494954789-3f2] Connection timeout after 15000ms

<150>Dec 11 18:16:05 web-server-03 myapp[7832]: [INFO] [auth] [1765494965234-3f5] User 5423 logged in successfully
```
